<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>WebSocket Sample</title>
    <script type="text/javascript">
        // WebSocketオブジェクト
        var webSocket = null;

        function auth() {
            var id = document.document.getElementById("id").value();
            var ticket = document.document.getElementById("ticket").value();
            alert("id=" + id);
            alert("ticket=" + ticket);
            var url = "wsauth?id=" + id + "&ticket=" + ticket;
            alert("url=" + url);
            var request =  new XMLHttpRequest();
            request.open("GET", url, true);
            request.onreadystatechange = function() {
                if (request.readyState == 4 && request.status == 200) {
                    //受信完了時の処理
                    var result = request.responseText;
                    alert("result:" + result);
                }
            }
            request.setRequestHeader("accept", "application/json;");
            request.send();
        }
        
        function open() {
            if (webSocket == null) {
                // WebSocket の初期化
                webSocket = new WebSocket(uri);
                // イベントハンドラの設定
                webSocket.onopen = onOpen;
                webSocket.onmessage = onMessage;
                webSocket.onclose = onClose;
                webSocket.onerror = onError;
            }
        }

        // 接続イベント
        function onOpen(event) {
        }

        // メッセージ受信イベント
        function onMessage(event) {
        }

        // エラーイベント
        function onError(event) {
        }

        // 切断イベント
        function onClose(event) {
        }


    </script>
</head>
<body>
    <input type="text" id="id" value="user01"/>
    <input type="text" id="ticket" value="ticket01"/>
    <input type="button" value="事前認証" onclick="auth()"/>
</body>
</html>
